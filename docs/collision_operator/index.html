<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Collision Operator · Ludwig</title><meta name="title" content="Collision Operator · Ludwig"/><meta property="og:title" content="Collision Operator · Ludwig"/><meta property="twitter:title" content="Collision Operator · Ludwig"/><meta name="description" content="Documentation for Ludwig."/><meta property="og:description" content="Documentation for Ludwig."/><meta property="twitter:description" content="Documentation for Ludwig."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Ludwig logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Ludwig</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><span class="tocitem">Mesh</span><ul><li><a class="tocitem" href="../mesh/mesh/">Overview</a></li><li><a class="tocitem" href="../mesh/marching_squares/">Marching Squares</a></li><li><a class="tocitem" href="../mesh/mesh_sb/">Single Band Mesh</a></li><li><a class="tocitem" href="../mesh/mesh_mb/">Multiband Meshes</a></li></ul></li><li class="is-active"><a class="tocitem" href>Collision Operator</a><ul class="internal"><li><a class="tocitem" href="#Single-Band-and-Naïve-Multiband"><span>Single Band and Naïve Multiband</span></a></li><li><a class="tocitem" href="#Improved-Multiband"><span>Improved Multiband</span></a></li></ul></li><li><a class="tocitem" href="../example/">Example</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Collision Operator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Collision Operator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/DavisThuillier/Ludwig.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/DavisThuillier/Ludwig.jl/blob/main/docs-build/src/collision_operator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Collision-Operator"><a class="docs-heading-anchor" href="#Collision-Operator">Collision Operator</a><a id="Collision-Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Collision-Operator" title="Permalink"></a></h1><h2 id="Single-Band-and-Naïve-Multiband"><a class="docs-heading-anchor" href="#Single-Band-and-Naïve-Multiband">Single Band and Naïve Multiband</a><a id="Single-Band-and-Naïve-Multiband-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Band-and-Naïve-Multiband" title="Permalink"></a></h2><p>For a single band with a momentum independent scattering potential <span>$V(\mathbf{q}) = V$</span>,</p><p class="math-container">\[    \mathbf{L}_{ij} = \frac{1}{\d A_i} \frac{2\pi}{1 - f^{(0)}_i} |V|^2 \frac{1}{(2\pi)^6} \sum_{m} (f^{(0)}_j (1 - f^{(0)}_m) \mathcal{K}_{ijm} - 2f^{(0)}_m (1 - f^{(0)}_j)\mathcal{K}_{imj}) \]</p><p>where</p><p class="math-container">\[    \mathcal{K}_{ijm} = \int_i d^2 \mathbf{k}_i \int_j d^2 \mathbf{k}_j \int_m d^2 \mathbf{k}_m (1 - f^{(0)}(\mathbf{k}_i + \mathbf{k}_j - \mathbf{k}_m)) \delta(\varepsilon_i + \varepsilon_j - \varepsilon_m - \varepsilon_\mu(\mathbf{k}_i + \mathbf{k}_j - \mathbf{k}_m)).\]</p><p>A first attempt at incorporating interband scattering was to perform a sum over the bands for the energy corresponding the final momentum computed by enforcing momentum conservation:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ludwig.Γabc!" href="#Ludwig.Γabc!"><code>Ludwig.Γabc!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Γabc!(ζ, a, b, c, T, Δε, hams::Vector{Function})</code></pre><p>Compute the integral</p><p class="math-container">\[    \mathcal{K}^\mu_{abc} \equiv \sum_{\mu} \int_a \int_b \int_c (1 - f^{(0)}(\mathbf{k}_a + \mathbf{k}_b + \mathbf{k}_c)) \delta(\varepsilon_a + \varepsilon_b - \varepsilon_c - \varepsilon^\mu(\mathbf{k}_a + \mathbf{k}_b - \mathbf{k}_c)) \]</p><p>where <span>$\mu$</span> denotes the band index of the dispersion in <code>hams</code> and </p><p class="math-container">\[    \int_i \equiv \frac{1}{a^2} \int_{\mathbf{k} \in \mathcal{P}_i} d^2\mathbf{k}\]</p><p>is an integral over momenta in patch <span>$\mathcal{P}_i$</span>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L7-L20">source</a></section><section><div><pre><code class="language-julia hljs">Γabc!(ζ, a, b, c, T, Δε, h::Function)</code></pre><p>When only a single band <code>h</code> is provided, compute the integration kernel without summing over bands. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L59-L63">source</a></section><section><div><pre><code class="language-julia hljs">Γabc!(ζ, a, b, c, T, Δε, itps::Vector{ScaledInterpolation})</code></pre><p>The same integral where energies are evaluated by interpolation of the bands over the 1st Brillouin Zone</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L66-L70">source</a></section></article><p>The collision matrix can then be populated in this simple model using</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Vector{Function}}" href="#Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Vector{Function}}"><code>Ludwig.electron_electron!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">electron_electron!(L, grid, Δε, T, hams::Vector{Function})</code></pre><p>Populate the collision matrix <code>L</code> defined on patches in <code>grid</code> assuming equal weight for interband scattering given explicit functions for each band in <code>hams</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L194-L198">source</a></section></article><p>or</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Vector{ScaledInterpolation}}" href="#Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Vector{ScaledInterpolation}}"><code>Ludwig.electron_electron!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">electron_electron!(L, grid, Δε, T, itps::Vector{ScaledInterpolation})</code></pre><p>Populate the collision matrix <code>L</code> defined on patches in <code>grid</code> assuming equal weight for interband scattering given gridded interpolations of bands in <code>itps</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L219-L223">source</a></section></article><h2 id="Improved-Multiband"><a class="docs-heading-anchor" href="#Improved-Multiband">Improved Multiband</a><a id="Improved-Multiband-1"></a><a class="docs-heading-anchor-permalink" href="#Improved-Multiband" title="Permalink"></a></h2><p>The above model is not realistic, however. The bands consist of hybridized orbitals which have different overlap. To account for this, the next simplest model one can propose for the scattering term is</p><p class="math-container">\[    U\sum_{i} \sum_{a,b} n_{i,a} n_{i,b}\]</p><p>where <span>$i$</span> represents a site index and <span>$a, b$</span> are orbital indices. To handle this perturbation in our framework of scattering using the Born approximation, we need to evaluate this interaction term in the eigenbasis of the bare Hamiltonian.</p><p class="math-container">\[\begin{aligned}
    \sum_i n_{i,a} n_{i, b} &amp;= \sum_{i}c^\dagger_{i,a} c_{i,a} c^\dagger_{i,b} c_{i,b}\\
    &amp;= \frac{1}{N^2} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{k}_3, \mathbf{k}_4} \left( e^{i (\mathbf{k}_3 + \mathbf{k}_4 - \mathbf{k}_1 - \mathbf{k}_2) \cdot \mathbf{R}_i}\right ) c^\dagger_{\mathbf{k}_3,a} c_{\mathbf{k}_1,a} c^\dagger_{\mathbf{k}_4,b} c_{\mathbf{k}_2,b}\\
    &amp;= \frac{1}{N^2} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{k}_3, \mathbf{k}_4} N \delta_{\mathbf{k}_4,\mathbf{k}_1 + \mathbf{k}_2 - \mathbf{k}_3} c^\dagger_{\mathbf{k}_3,a} c_{\mathbf{k}_1,a} c^\dagger_{\mathbf{k}_4,b} c_{\mathbf{k}_2,b}\\
    &amp;= \frac{1}{N} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{q}} c^\dagger_{\mathbf{k}_1 - \mathbf{q},a} c_{\mathbf{k}_1,a} c^\dagger_{\mathbf{k}_2 + \mathbf{q},b} c_{\mathbf{k}_2,b}\\
    &amp;= \frac{1}{N} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{q}} \sum_{\mu\nu\sigma\tau} c^\dagger_{\mathbf{k}_1 - \mathbf{q},\sigma} \left( W_{\mathbf{k}_1 - \mathbf{q}}^{a \sigma}\right)^* W_{\mathbf{k}_1}^{a \mu} c_{\mathbf{k}_1, \mu} c^\dagger_{\mathbf{k}_2 + \mathbf{q},\tau} \left( W_{\mathbf{k}_2 + \mathbf{q}}^{b \tau}\right)^* W_{\mathbf{k}_2}^{b \nu} c_{\mathbf{k}_2, \nu}
\end{aligned}\]</p><p>From the above, we can define the <em>interband connection</em> as</p><p class="math-container">\[    F_{\mathbf{k}_1, \mathbf{k}_2}^{\mu\nu} \equiv \sum_a \left(W_{\mathbf{k}_1}^{a \mu} \right)^* W_{\mathbf{k}_2}^{a \nu} = \sum_a \left(W^\dagger_{\mathbf{k}_1}\right)^{\mu a} W_{\mathbf{k}_2}^{a \nu}  = \left(W^\dagger_{\mathbf{k}_1} W_{\mathbf{k}_2} \right)^{\mu \nu } \]</p><p>so the interaction term becomes</p><p class="math-container">\[U\sum_{i} \sum_{a,b} n_{i,a} n_{i,b} = \frac{U}{N} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{q}} \sum_{\mu\nu\sigma\tau} c^\dagger_{\mathbf{k}_1 - \mathbf{q},\sigma}  F^{\sigma\mu}_{\mathbf{k}_1 - \mathbf{q}, \mathbf{k}_1}  c_{\mathbf{k}_1, \mu} c^\dagger_{\mathbf{k}_2 + \mathbf{q},\tau} F^{\tau\nu}_{\mathbf{k}_2 + \mathbf{q}, \mathbf{k}_2} c_{\mathbf{k}_2, \nu}.\]</p><p>The collision matrix elements can then be populated using </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Function, Int64, Function}" href="#Ludwig.electron_electron!-Tuple{AbstractMatrix{&lt;:Real}, Vector{Patch}, Real, Real, Function, Int64, Function}"><code>Ludwig.electron_electron!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">electron_electron!(L, grid, Δε, T, H, N, cf_eigvecs!)</code></pre><p>Populate the collision matrix <code>L</code> defined on patches in <code>grid</code> for a scattering perturbation to the Hamiltonian of the form</p><pre><code class="nohighlight hljs">V = \frac{U}{N} \sum_{a,b} \sum_{\mathbf{k}_1, \mathbf{k}_2, \mathbf{q}} \sum_{\mu\nu\sigma\tau} c^\dagger_{\mathbf{k}_1 - \mathbf{q},\sigma} \left( W_{\mathbf{k}_1 - \mathbf{q}}^{a \sigma}\right)^* W_{\mathbf{k}_1}^{a \mu} c_{\mathbf{k}_1, \mu} c^\dagger_{\mathbf{k}_2 + \mathbf{q},\tau} \left( W_{\mathbf{k}_2 + \mathbf{q}}^{b \tau}\right)^* W_{\mathbf{k}_2}^{b \nu} c_{\mathbf{k}_2, \nu}</code></pre><p>The field <code>w</code> of the type <code>Patch</code> gives the column of <span>$W_\mathbf{k}$</span> corresponding to the field <code>band_index</code> evaluated at the field <code>band_index</code>.</p><p>The function <code>cf_eigvecs!</code> is a convenience function that speeds up performance by populating a pre-allocated matrix with the closed form solution for the eigenvectors of <code>H</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L244-L254">source</a></section></article><p>which is threaded to improve performance and uses the alternate kernel function <code>ee_kernel!</code> instead of <code>Γabc!</code> for improved memory allocation handling when dealing with the larger memory requirements of this interband model.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ludwig.ee_kernel!" href="#Ludwig.ee_kernel!"><code>Ludwig.ee_kernel!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ee_kernel!(K, grid, i, T, Δε, itps, f0s)</code></pre><p>Populate the preallocated array <code>K</code> with the values of <span>$\mathcal{K}^\mu_{ijm}$</span> for the row <code>i</code> of the collision operator.</p><p>Energies are calculated from <code>itps</code>, the interpolation of each band and <code>f0s</code> is a vector of the Fermi-Dirac distribution evaluated for the energy of each patch in <code>grid</code> at temperature <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DavisThuillier/Ludwig.jl/blob/37b62ed0121617dd44620301abeb94d162bd68e1/src/integration.jl#L114-L120">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mesh/mesh_mb/">« Multiband Meshes</a><a class="docs-footer-nextpage" href="../example/">Example »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 29 July 2024 23:27">Monday 29 July 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
